<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Generate Keys (PHT)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="styles.css" rel="stylesheet" />
</head>
<body>
  <div class="container">
    <h1>Generate Keys (Philippine Standard Time)</h1>

    <section class="card">
      <h2>Request new keys (runs workflow)</h2>
      <div class="grid">
        <label>
          Unit
          <select id="unit">
            <option>days</option>
            <option>weeks</option>
            <option>months</option>
            <option>years</option>
          </select>
        </label>
        <label>
          Amount
          <input id="amount" type="number" min="1" value="7" />
        </label>
        <label>
          Count (# keys)
          <input id="count" type="number" min="1" value="5" />
        </label>
        <label>
          Optional tag
          <input id="tag" type="text" placeholder="e.g. promo-august" />
        </label>
      </div>

      <details class="advanced">
        <summary>Advanced (GitHub repo + token)</summary>
        <div class="grid">
          <label>
            GitHub Owner
            <input id="owner" type="text" placeholder="your-username-or-org" />
          </label>
          <label>
            Repo
            <input id="repo" type="text" placeholder="your-repo" />
          </label>
          <label>
            Branch/Ref
            <input id="ref" type="text" value="main" />
          </label>
          <label>
            Workflow File
            <input id="workflow" type="text" value="generate-keys.yml" />
          </label>
          <label>
            PAT (repo + workflow scope)
            <input id="token" type="password" placeholder="GitHub Personal Access Token" />
          </label>
        </div>
        <p class="note">
          Your token is used client-side to call GitHub’s API
          (<code>workflow_dispatch</code>). It is <strong>not</strong> stored.
          For public repos, you can omit the token for “View keys” but you
          <em>do</em> need a token to trigger a run.
        </p>
      </details>

      <div class="actions">
        <button id="runBtn">Request Keys (trigger workflow)</button>
        <span id="runStatus" class="status"></span>
      </div>
    </section>

    <section class="card">
      <h2>Latest generated keys</h2>
      <div class="grid">
        <label>
          Raw JSON URL (latest)
          <input id="jsonUrl" type="text" placeholder="https://raw.githubusercontent.com/OWNER/REPO/BRANCH/keys/latest.json" />
        </label>
      </div>
      <div class="actions">
        <button id="fetchBtn">Fetch Latest</button>
        <span id="fetchStatus" class="status"></span>
      </div>

      <pre id="output" class="output"></pre>
      <table id="table" class="table hidden">
        <thead>
          <tr>
            <th>#</th>
            <th>Key</th>
            <th>Expires (PHT)</th>
            <th>Expires (Unix)</th>
            <th>Tag</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </section>

    <footer>
      <small>All expirations computed on the server in Asia/Manila (GMT+8).</small>
    </footer>
  </div>

  <script src="script.js"></script>
</body>
</html>
